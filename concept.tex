\TOWRITE{NT/...}{Finalise}
\TOWRITE{ALL}{Proofread concept and approach pass 2}

\subsection{Concept and Methodology}\label{sec:concept_methodology}
\eucommentary{5-8 pages}

\TODO{Check we have addressed all mandatory topics}

% \subsubsection{Concept}%\label{sec:concept}
%
% Open Science is the principle that science, in order to be most
% {impactful} and {socially responsible}, should be done
% {publicly}, with as much of the scientific process and products
% accessible, reviewable, reproducible and reusable by as many members of
% the global community as possible.
%
% There are exciting opportunities for Open Science for almost all academic fields
% in the modern age of computational science. As more and more research takes the
% form of code and/or data, the opportunity to share, reproduce, and reuse
% scientific work is greater than ever, even enabling new forms of
% {interdisciplinary collaboration}, and interoperable and re-usable results and
% tools.
%
%  Simultaneously, there are obstacles -- both technical and social -- to
% making open science and reproducible science a practical reality. The challenges
% include: If a researcher has code and/or data to publish, how is that best
% done? How do researchers learn {best practices for reproducible science} in
% their field? How do previously disconnected fields benefit from each other's
% work as the same computational challenges are faced again and again by different
% communities? How can scientists be encouraged to make their work reproducible?
%
% These are the questions that guide the \TheProject{} project.

\subsubsection{Supporting Open, Useful, and Reproducible Computational
  Environments}\label{sec:SOURCE}

Our project is titled ``\emph{Supporting Open, Useful, and Reproducible Computational Environments.}'':
\begin{itemize}
\item The work done is this project will be \emph{Supporting} scientists in their
  endavours to make their work more reproducible and re-usable.
\item We believe in the value of \emph{Open} science and \emph{Open} source. The
  best reproducibility and re-usability of scientific results is given through
  complete transparency of the steps taken in the derivation of a result. For
  the computational aspects this means to make all simulation and/or
  post-processing and analysis steps open source. While this may not always be
  possible, we advocate such openness as the best practice for reproducible science.

  All work done, including software, training and documentation materials, will
  be open source and available through an open access license.

  (We note that the collective development of the grant proposal you are reading
  is also done as open source, and can be inspected at
  \url{http://github.com/minrk/horizon-widera-2022} for those interested.)

\item Measures towards better reproducibility have to be \emph{Useful} and
  practical: if a proposed approach or tool burdens the scientist with
  additional work, or requires significant additional skills, it becomes less
  likely to be widely accepted.

  The philosophy we support here is that the proposed (Binder) tools for
  reproducibility are based on existing standards which are already
  adopted by many and can be considered best practice.

\item Within the wide field of reproducibility in science, we focus in this
  project on the improvement of the automatic generation of \emph{Reproducible
    Computational Environments}.
\end{itemize}

\subsubsection{Outline of concept}

In the following we explain our concept and the technology on which this
proposed project builds in more detail.
\begin{itemize}
\item Sections \fullref{sec:reproducibility} and
  \fullref{sec:reproducibility-challenges} contextualise the proposed work
  within the wide field of reproducibility.
\item Section \fullref{sec:reproducibility-concept} summarises our concept and
  approach concisely.

\item To prepare the more detailed description of the concept and the content of
  the Work Packages, we use Section
  \fullref{sec:terminology-and-repository-example} to introduce key terminology
  together with an example for computational reproducibility.

\item Sections \fullref{sec:project-jupyter} and \fullref{seq:project-binder}
  introduce the Jupyter and Binder projects, respectively.

\item Section \fullref{sec:binder-for-reproducibility} explains the use of
  Binder tools for reproducible science.

\item The methodology for this project is summarised in section
  \fullref{sec:methodology}.

\end{itemize}

%\TODO{Do we need to keep anything from the commented out lines here?}

%
% With so much research being done that wants to be Open and Reproducible,
% how can we make Science
%
% \begin{enumerate}
%     \item as \textbf{easy} as possible to share and reproduce?
%     \item as \textbf{useful} as possible to other researchers and the public?
% \end{enumerate}
%
%
%
%
%
% \noindent Our plan for \textbf{increasing the reproducibility of scientific results} can be summarised as:
%
% \begin{enumerate}
% \item improve and maintain \textbf{common software infrastructure} used for
%   reproducing computational results,
% \item develop the Jupyter ecosystem to improve capabilities to \textbf{better
%   serve Reproducible Open Science},
% \item \textbf{guide, validate, and demonstrate} our developments through
%   collaboration with a wide variety of application domains,
% \item enable students and researchers to perform Reproducible Open Science through
%   \textbf{training and education}, and improving inclusiveness by focusing
%   these on under-served and under-represented communities
% \end{enumerate}

\medskip

\subsubsection{Reproducibility}\label{sec:concept}\label{sec:reproducibility}

Before describing the focus of the work that we propose here, we want to embed
this into the much wider context of reproducibility challenges.

We will exclude the challenges of reproducing \emph{experimental} data. Our
study starts at the point where such experimental data is available in digital
form.

We will focus on the challenge of computational reproducibility: can we carry out
the same data analysis, creation of figures and tables as they are presented in
a paper, at a later stage, and get to the same results?

Such tables and figures in a publication may be computed from the analysis of
some type of raw data which could originate an experiment, another publication,
a data base, post-processing of another data set or from executing computer
simulations.

% Where additional software, such as analysis scripts, input files
% and software for the simulation are needed,

\subsubsection{Challenges of Reproducibility}\label{sec:reproducibility-challenges}

The challenges of such ``computational reproducibility'' include:
\begin{itemize}
\item Are the different processing steps for that data recorded? This could be
the order in which analysis scripts need to be executed -- for example to
compute intermediate results -- which will be turned into a figure in the last
step?

We will call this sequence of steps the \emph{workflow}. This workflow could be
archived -- for example -- through a \softwarename{README.txt} file, or scanned
pages of a hand-written laboratory notebook as a pdf file, or as a
machine-executable script (or a Jupyter notebook).

This is particularly challenging where software is used which can only be
controlled via a Graphical User Interface, as it may require manual recording
and description of the different clicks and steps in laboratory logbook.

\item Are all the scripts and configuration files (and more generally all
software) that is needed in this process known and archived?

\item Where software is involved, have we recorded which version of that
software is needed (or was used)? If compilation is required, do we know which
compilers (and which version) and which additional dependencies are required?

\item Are there instructions how to obtain / compile the required dependencies,
and the software itself (in particular where this is about simulation based
science or more complex analysis and interpretation software tools)?

\item Where raw data is required, is this archived, accessible, and sufficiently
documented that the format is understandable?
\end{itemize}


\subsubsection{Reproducibility concept}\label{sec:reproducibility-concept}

We can classify the reproducibility challenges listed above into different categories:

\begin{description}
\item[1. Workflow]: Are the processing commands (and their order)
correctly recorded? Do we know which part of the data set the analysis is meant
to be applied to? This is to a significant degree a question of the organisation
and documentation of the research process.

\item[2. Software environment]: Can we recreate the software environment that is
required to execute these commands?

\item[3. Importance]: Is the researcher convinced that investing effort into making
their work more reproducible is a worth while investment? This is a wide topic,
touching on expectations, existing cultures, lack of metrics that acknowledge
reproducibility efforts, and policies.

\item[4. Other]: There are other related topics, for example the challenge of
archival of (large) research data sets, of making the data FAIR, and the (for
some domains important) bit-wise reproducibility.
\end{description}

In this proposal, we start from practices that researchers increasingly adopt,
and which we argue are \emph{good reproducibility practices}. We propose to carry
out additional work to \emph{improve the toolset enabling this practice}.

To deal with the \emph{Workflow} challenges, we recommend to automate the
workflow steps as much as possible. In particular, the use of Jupyter Notebooks
to orchestrate the execution of commands seems effective~\cite{Beg2021}.
The use of the notebook is
perceived by many as an improvement of their research effectiveness because
it supports ``Thinking with Code and Data''~\cite{Granger2021}. A such, the
practice of using Notebooks (which helps improving research effectiveness) has
the very positive side effect of making the work more reproducible. (However, we
note that an important task of this project is to support reproducible science
that does not make use of Jupyter Notebooks.)

To deal with the \emph{Software environment} challenge, we recommend to follow
standard practices to describe software requirements. The \emph{focus of this
project is to extend the capabilities of the \repotodocker{} tool} to be able to
\emph{automatically create software environments} based on such software
requirement descriptions.

We can only partially address the \emph{Importance} challenge as this needs
concerted efforts from many stakeholders (such as employers of researchers,
research funders, publishers). However, we will offer training that advocates
the value of open science and that teaches existing best practice in
effective computational science. The step from following such best practice to
making the work reproducible is -- given the Binder tools we want to develop
further here -- relatively small, or even possible without additional effort.

The \emph{Other} challenges are mostly outside the focus of this work
(although our proposal will also assist in reproducible and FAIR data
publishing, see for example Task \taskref{applications}{data-publishing}).


% \subsubsection{Terminology and repository example}\label{sec:terminology-and-repository-example}

\subsubsection{Reproducibility Example}\label{sec:terminology-and-repository-example}

\begin{figure}[htb]\centering
  \includegraphics[width=0.9\textwidth]{use-cases-binder-logbook-solution.png}
  \caption{A typical use case for Binder-based reproducibility using Jupyter notebooks in research.
            Image by Juliette Belin for the OpenDreamKit project, used under
            CC-BY-SA.}\label{fig:use-cases-binder}
\end{figure}

We start with a description of a use-case making use of existing Binder-based
tools for computational reproducibility. Start from this base-line, we can
explain what progress and additional impact we will enable through this project.

Figure~\ref{fig:use-cases-binder} depicts how a scientist can use a Jupyter
notebook and the Binder software to make her research results easily
reproducible and re-usable. In short:
\begin{itemize}
\item Scientist Jane has created a notebook that carries out computations or
  data processing and creates a figure based on those results. For the purpose
  of the introduction of this workflow, we assume that
  Figure~\ref{fig:reproducibility-example-covid} shows this figure.

\item She has made the notebook and raw data available in a public repository
  (for our example at\newline
  \mbox{\url{https://github.com/fangohr/reproducibility-repository-example}}).

\item As she has described what software is needed to execute her notebook (more
  details below), it is possible for all interested scientists (and anybody
  else, including the reviewers of this proposal) to \emph{reproduce} her
  figure:

  To reproduce the figure, one needs to visit the URL\newline
  \mbox{\url{https://mybinder.org/v2/gh/fangohr/reproducibility-repository-example/HEAD?labpath=figure1.ipynb}}
  in a browser, and then wait a minute or so for a dedicated computational
  environment to be created and started. Then select 'Run' -> 'Run all cells'
  from the menu of the interactive Jupyter notebook that will appear in the
  browser.

  At that point, the computational steps that Jane has carried out to create her
  result are repeated, and the results are \emph{reproduced}.
  
\item Because all the computational steps are captured in the Jupyter notebook,
  they can be inspected and interrogated if desired. In particular, the steps
  can be modified and re-executed: this allows very efficient \emph{re-use} of
  the results by other researchers.
\end{itemize}

We provide a more detailed description of the components and steps in this
process in the following sections \ref{sec:terminology} to \ref{sec:mybinder}.

The reproducibility workflow shown in Figure~\ref{fig:use-cases-binder} is
working today, and we provide estimates on the number of current users in
section \ref{sec:mybinder}. The work proposed for this project will build on
this existing technology and (i) make it more robust and easier to use
(\WPref{reproducibility}), and (ii) extend the functionality (\WPref{impact}) so
that the existing tools can be used in many more use cases
(\WPref{applications}).

We note in particular that the Binder-enabled workflow for reproducibility has
originally been developed to reproduce results that are created within Jupyter
Notebook (as shown in Figure~\ref{fig:use-cases-binder}). As part of this
project, we will extend the Binder tool functionality, so that reproducible
computational environments can be created and used in studies that do not make
use of Jupyter notebooks.

\begin{figure}
  \centering
  \includegraphics[width=0.8\textwidth]{images/figure1.pdf}
  \caption{Figure (\softwarename{figure1.pdf}) which can be reproduced in our explanatory repository example
    \cite{ReproducibilityRepositoryExample2022}. \label{fig:reproducibility-example-covid}}
\end{figure}


\subsubsection{Terminology}\label{sec:terminology}

For clarity, we define some terms that have been used already above which refer to
throughout this proposal. We illustrate the terms in the context of the
reproducibility example in Section~\ref{sec:terminology-and-repository-example}.

In particular, we imagine that we have a publication that contains
figure~\ref{fig:reproducibility-example-covid} as a result, and we want to
archive and make available \cite{ReproducibilityRepositoryExample2022} the
necessary information for others to reproduce that figure.

\begin{description}
\item[Repository] We refer to a \emph{repository} as a collection of files.

The \emph{purpose} of the repository in our context is to archive information to make
research results reproducible.

Such a repository could be a git repository (which could be hosted on Github,
Bitbucket, Gitlab, or other services), but it could also just be a zip file of a
collection of files.

The repository could be made publicly available, for example through Zenodo,
Figshare, as an electronic supplementary to a publication, or through Github.

It is not unusual that a larger number of files might be
organised in subdirectories within the repository.

Our example repository\footnote{
  https://github.com/fangohr/reproducibility-repository-example/} \cite{ReproducibilityRepositoryExample2022} contains the following files:

\begin{description}
\item[\softwarename{README.md}]: an overview of the content of the repository
\item[\softwarename{figure1.ipynb}]: notebook that creates \softwarename{figure1.pdf}gs from
  the raw data. Could also be realised through a script of some kind.
\item[\softwarename{requirements.txt}]: software specification
\item[\softwarename{time\_series\_covid19\_deaths\_global.csv}]: raw data
\end{description}

\item[Script] An machine executable file (for example a Bash, Python, Perl
script, Makefile or similar). Such scripts can execute data processing commands,
and are often part of a repository to make the (automatic) reproduction of
results possible.

In our example, the necessary steps to create the figure from the raw data are
gathered in the notebook \texttt{figure1.ipynb}.

\item[Notebook] A Jupyter Notebook. In short, an executable document that can
  combine text, code and computation results. A Jupyter notebook can act like a
  script. The notebook is explained in Section \fullref{sec:jupyter-notebook}.

\item[Software specification] The software specification depends on the software
  tools used. In our example, the \texttt{requirements.txt} file contains
\begin{verbatim}
pandas==1.3.4
matplotlib==3.4.3
\end{verbatim}
to indicate that we need the pandas and matplotlib package with the respective
versions 1.3.4 and 3.4.3.

\item[Software environment] All the software that needs to be available and
  installed to execute the scripts and (and if desired) Jupyter notebooks.

\item[Project Binder] The Project Binder is described in Section
\ref{seq:project-binder}. It is part of the Jupyter ecosystem of tools, and
allows to convert a repository with Jupyter notebooks into an browser-hosted
environment, in which the notebooks can be executed interactively (and thus
results can be reproduced). \TODO{Point to binder section}

\item[Binder tools] The Bindertools consist of BinderHub (\TODO{See XXX}) and
\repotodocker{}. \TODO{@min - how do we summarise the role of BinderHub in one sentence?}

\item[\repotodocker] \repotodocker{} is a tool that can automatically create a
\emph{software environment} (currently within a Docker container) in which the
notebooks and scripts of a repository can be executed. \TODO{Point to dedicated section.}
\end{description}

\input{project-jupyter.tex}
\input{project-binder.tex}

\subsubsection{Methodology}\label{sec:methodology}

\textbf{Improving the robustness of reproducible environments (\WPref{reproducibility})}\\
Finally, we are explicitly allocating time in \WPref{core} for maintaining
Jupyter software, as well as new development
 % (\taskref{core}{maintenance}).
Maintenance is crucial to creating reliable, sustainable software,
but its cost is often swept under the rug in funding applications
because of the perceived pressure to focus on novelty.
Being up front and explicit about this cost is critical to the sustainability
of open source open science.

\medskip
\noindent\textbf{Broadening  (\WPref{impact})}\\
In addition to improving how successfully and how often tools like \repotodocker{} reproduce environments,
we aim to broaden the impact of the tools by making them useful in more contexts.
The existing software makes certain assumptions about where it will run,
made for the purposes of limiting maintenance scope of the Binder project.
As the project has matured, certain expansions of scope are appropriate,
as seen in the existing demand for new features in the project.

We further propose improvements to the wider Binder ecosystem
to expand the impact of the tools in more contexts to be useful to more researchers
and more institutions.
In particular, we have identified planned improvements:

\begin{itemize}
  \item Binder and its crucial software component \emph{repo2docker}
  \item relaxing Kubernetes assumption
  \item running on HPC
  \item more buildpacks
    % (\taskref{ecosystem}{r2d-and-binder}).

\end{itemize}

\medskip\noindent\textbf{Beyond the improvement to \TheProject tools
  (\WPref{applications}, \WPref{education})}\\
Beyond the improvement to the Binder tools for reproducility, we plan on
\begin{itemize}
\item Design, implementation, application, demonstration and
  evaluation of multiple demonstrators, that cover research fields such as
  \TOWRITE{}{photon and neutron science, geosciences},
  and also interests of participating SMEs (\WPref{applications}).
\item Producing \emph{training and education material} to disseminate
  the ability to do reproducible computational science using the tools
  we develop, among others (\WPref{education}).
\end{itemize}

\medskip
\noindent
\textbf{The science
  demonstrators}\label{sec:science-demonstrators-in-concept}\\

We describe the context and challenges for each demonstrator in this
section. The particular planned activities are shown in the
corresponding tasks in \WPref{applications}.\\


\TOWRITE{}{

1 page: National or international research or innovation activities
½ page: bringing together expertise and methods from different disciplines
½ page: social science and humanities - how do we integrate them, or why do we not need them
1 page: gender dimension. How taken into account in the research content (not the research team). Or justify why not relevant.
1 page: open science practices and implementation
1 page: research data management and management of other research outputs. (Also FAIR)

}
